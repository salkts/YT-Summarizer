<!DOCTYPE html>
<html>
<head>
  <title>YT Summary</title>
  <link rel="stylesheet" href="sidebar.css">
</head>
<body>
  <div id="sidebar-container">
    <!-- Main View -->
    <div id="main-view">
      <div class="header">
        <div class="header-left">
          <h1>YT Summarizer</h1>
        </div>
        <div class="header-actions-row">
          <div id="time-saved-container" class="time-saved">
            <span id="time-saved-text">Time saved: --</span>
          </div>
          <div class="header-actions">
            <button id="history-btn" class="btn-icon" title="History"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg></button>
            <button id="theme-toggle-btn" class="btn-icon" title="Toggle Theme"></button>
            <button id="settings-btn" class="btn-icon" title="Settings"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg></button>
            <button id="close-btn" class="btn-icon" title="Close"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
          </div>
        </div>
      </div>
      <div id="content">
        <div id="message-container" class="card">
          <div class="card-content">
            <p id="message">Ready to summarize the video!</p>
            <button id="summarize-btn" class="btn btn-primary">Generate Summary</button>
          </div>
        </div>
        <div id="loading-container" class="card hidden">
          <div class="card-content">
            <div class="loading-spinner"></div>
            <p>Analyzing video content...</p>
            <p class="loading-sub">This may take 10-30 seconds for longer videos</p>
          </div>
        </div>
        <div id="summary-container" class="card hidden">
            <div id="history-banner" class="history-banner hidden">
                <div class="history-banner-content">
                    <span class="history-banner-text">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="history-icon"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                        Viewing history
                    </span>
                    <button id="summarize-current-btn" class="btn btn-primary btn-small">Summarize Current Video</button>
                </div>
            </div>
            <div class="card-header">
                <h2 class="card-title">Summary</h2>
                <div class="summary-actions">
                  <span id="video-duration" class="video-info"></span>
                  <a id="video-link" class="video-link hidden" target="_blank" title="Go to Video">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-small"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15,3 21,3 21,9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                    Go to Video
                  </a>
                  <button id="regenerate-btn" class="btn-icon" title="Regenerate Summary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg></button>
                </div>
            </div>
            <div class="card-content">
                <div id="summary-text"></div>
                <h3 class="card-title" style="margin-top: 1rem;">Action Steps</h3>
                <ul id="action-steps-list"></ul>
                <div id="concepts-container" class="hidden">
                    <h3 class="card-title" style="margin-top: 1rem;">Key Concepts & Timestamps</h3>
                    <p class="concepts-subtitle">Click any timestamp to jump to that moment in the video</p>
                    <ul id="concepts-list"></ul>
                </div>
            </div>
        </div>
        <div id="error-container" class="card hidden">
            <div class="card-content">
                <p id="error-message"></p>
                <button id="retry-btn" class="btn btn-secondary" style="margin-top: 10px;">Try Again</button>
            </div>
        </div>
      </div>
    </div>

    <!-- History View -->
    <div id="history-view" class="hidden">
      <div class="header">
        <div class="header-left">
          <h2>History</h2>
        </div>
        <div class="header-actions-row">
          <div></div>
          <div class="header-actions">
            <button id="back-from-history-btn" class="btn-icon" title="Back to Summary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
          </div>
        </div>
      </div>
      <div class="history-actions">
        <button id="clear-history-btn" class="btn btn-secondary">Clear History</button>
      </div>
      <div id="history-list"></div>
    </div>

    <!-- Settings View -->
    <div id="settings-view" class="hidden">
      <div class="header">
        <div class="header-left">
          <h2>Settings</h2>
        </div>
        <div class="header-actions-row">
          <div></div>
          <div class="header-actions">
            <button id="back-btn" class="btn-icon" title="Back to Summary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
          </div>
        </div>
      </div>
      <div class="settings-content">
        <div class="card">
          <div class="card-content">
            <div class="form-group">
              <label for="api-key">Gemini API Key</label>
              <input type="password" id="api-key" class="form-input" placeholder="Enter your API Key">
              <small class="help-text">Get your free API key from <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a></small>
            </div>
          </div>
        </div>
        <div class="card">
            <div class="card-content">
                <div class="form-group">
                    <div class="label-with-reset">
                        <label for="system-prompt">System Prompt</label>
                        <button id="reset-prompt-btn" class="btn-reset" title="Reset to Default">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path><path d="M3 3v5h5"></path></svg>
                            Reset
                        </button>
                    </div>
                    <textarea id="system-prompt" class="form-textarea" rows="8" readonly></textarea>
                    <div id="prompt-readonly-notice" class="prompt-notice">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="notice-icon">
                            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                            <line x1="12" y1="9" x2="12" y2="13"></line>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                        Click to modify the system prompt (advanced users only)
                    </div>
                    <small class="help-text">Customize how the AI analyzes and summarizes videos</small>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Statistics</h3>
            </div>
            <div class="card-content">
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-label">Time Saved</span>
                        <span id="stats-time-saved" class="stat-value">--</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Videos Summarized</span>
                        <span id="stats-videos-count" class="stat-value">--</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="settings-actions">
          <button id="save-settings-btn" class="btn btn-primary">Save Settings</button>
          <p id="save-confirm" class="hidden">Settings saved!</p>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="modal hidden">
      <div class="modal-overlay"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3>Clear History</h3>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to clear all history and reset statistics?</p>
          <p class="modal-warning">This action cannot be undone.</p>
        </div>
        <div class="modal-actions">
          <button id="cancel-clear-btn" class="btn btn-secondary">Cancel</button>
          <button id="confirm-clear-btn" class="btn btn-primary">Clear All</button>
        </div>
      </div>
    </div>

    <!-- System Prompt Warning Modal -->
    <div id="prompt-warning-modal" class="modal hidden">
      <div class="modal-overlay"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline; margin-right: 8px; vertical-align: middle;">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
              <line x1="12" y1="9" x2="12" y2="13"></line>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            Advanced Feature Warning
          </h3>
        </div>
        <div class="modal-body">
          <p><strong>You're about to modify the system prompt that controls how the AI analyzes videos.</strong></p>
          <p>This is an advanced feature that can significantly change how summaries are generated. Incorrect modifications may result in:</p>
          <ul class="warning-list">
            <li>Poor quality summaries</li>
            <li>Missing timestamps or action steps</li>
            <li>Incorrect JSON formatting leading to errors</li>
          </ul>
          <p class="modal-warning">Only proceed if you understand how AI prompts work and are comfortable troubleshooting issues.</p>
        </div>
        <div class="modal-actions">
          <button id="cancel-prompt-edit-btn" class="btn btn-secondary">Cancel</button>
          <button id="confirm-prompt-edit-btn" class="btn btn-primary">I Understand, Continue</button>
        </div>
      </div>
    </div>
  </div>
  <script src="sidebar.js"></script>
</body>
</html>